-- Axe Smash Trap Selector UI
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

local selectedTargets = {}
local trapRadius = 15
local trapPoints = 20
local spamDelay = 0.15

-- GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "TrapSelectorUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game.CoreGui

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 180, 0, 300)
Frame.Position = UDim2.new(1, -190, 0.2, 0)
Frame.BackgroundColor3 = Color3.fromRGB(10, 0, 20)
Frame.BorderSizePixel = 0
Frame.Parent = ScreenGui

Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 10)

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.SortOrder = Enum.SortOrder.Name
UIListLayout.Padding = UDim.new(0, 4)
UIListLayout.Parent = Frame

-- Create player button
local function createPlayerButton(player)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -10, 0, 30)
    btn.BackgroundColor3 = Color3.fromRGB(30, 0, 50)
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Text = player.DisplayName
    btn.Font = Enum.Font.Code
    btn.TextSize = 14
    btn.Parent = Frame

    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
    local stroke = Instance.new("UIStroke", btn)
    stroke.Color = Color3.fromRGB(255, 0, 200)

    btn.MouseButton1Click:Connect(function()
        local isSelected = selectedTargets[player] == true
        selectedTargets[player] = not isSelected
        btn.TextColor3 = selectedTargets[player] and Color3.fromRGB(0,255,100) or Color3.fromRGB(255,255,255)
    end)

    player.CharacterAdded:Connect(function()
        selectedTargets[player] = false
        btn.TextColor3 = Color3.fromRGB(255,255,255)
    end)

    player.AncestryChanged:Connect(function(_, parent)
        if not parent then
            selectedTargets[player] = nil
            btn:Destroy()
        end
    end)
end

for _, p in ipairs(Players:GetPlayers()) do
    if p ~= LocalPlayer then
        createPlayerButton(p)
    end
end

Players.PlayerAdded:Connect(function(p)
    if p ~= LocalPlayer then
        createPlayerButton(p)
    end
end)

-- Tool spam logic
local function findToolAndRemote()
    local tool = LocalPlayer.Backpack:FindFirstChild("Axe Smash") or LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Axe Smash")
    local remote = tool and tool:FindFirstChild("Remote")
    return tool, remote
end

-- Trap spam loop
RunService.Heartbeat:Connect(function()
    local _, remote = findToolAndRemote()
    if not remote then return end

    for player, active in pairs(selectedTargets) do
        if active and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = player.Character.HumanoidRootPart
            local alive = player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0
            if alive then
                for i = 1, trapPoints do
                    local angle = math.rad((360 / trapPoints) * i)
                    local offset = Vector3.new(math.cos(angle) * trapRadius, 30, math.sin(angle) * trapRadius)
                    local pos = hrp.Position + offset + Vector3.new(0, 2, 0)
                    remote:FireServer(CFrame.new(pos))
                end
            else
                selectedTargets[player] = false
            end
        end
    end
end)

print("âœ… Axe Smash Trap initialized")
