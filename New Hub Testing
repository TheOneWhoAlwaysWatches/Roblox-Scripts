-- Recreate Script Hub UI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ScriptHubUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game.CoreGui

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 800, 0, 400)
MainFrame.Position = UDim2.new(0.5, -400, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
MainFrame.BorderColor3 = Color3.fromRGB(255, 0, 0)
MainFrame.BorderSizePixel = 2
MainFrame.Parent = ScreenGui

-- LoopBring Button
local LoopBringButton = Instance.new("TextButton")
LoopBringButton.Name = "LoopBringButton"
LoopBringButton.Size = UDim2.new(0, 100, 0, 25)
LoopBringButton.Position = UDim2.new(0, 2, 0, 2)
LoopBringButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
LoopBringButton.BorderColor3 = Color3.fromRGB(255, 0, 0)
LoopBringButton.Text = "[LoopBring]"
LoopBringButton.Font = Enum.Font.SourceSansBold
LoopBringButton.TextSize = 14
LoopBringButton.TextColor3 = Color3.fromRGB(255, 0, 0)
LoopBringButton.Parent = MainFrame

-- Divider under LoopBring and Tabs
local TopDivider = Instance.new("Frame")
TopDivider.Size = UDim2.new(1, 0, 0, 1)
TopDivider.Position = UDim2.new(0, 0, 0, 26)
TopDivider.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
TopDivider.BorderSizePixel = 0
TopDivider.Parent = MainFrame

-- Left Divider Line for LoopBring
local LeftDivider = Instance.new("Frame")
LeftDivider.Size = UDim2.new(0, 2, 1, -26)
LeftDivider.Position = UDim2.new(0, 100, 0, 26)
LeftDivider.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
LeftDivider.BorderSizePixel = 0
LeftDivider.Parent = MainFrame

-- Top Tabs
local function createTab(name, icon, position)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 80, 0, 25)
    btn.Position = UDim2.new(0, position, 0, 0)
    btn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    btn.BorderSizePixel = 0
    btn.Text = icon .. " " .. name
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 18
    btn.TextColor3 = Color3.fromRGB(0, 255, 0)
    btn.Parent = MainFrame

    local divider = Instance.new("Frame")
    divider.Size = UDim2.new(0, 1, 1, 0)
    divider.Position = UDim2.new(1, 0, 0, 0)
    divider.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    divider.BorderSizePixel = 0
    divider.Parent = btn
end

createTab("Tips", "üß†", 110)
createTab("Main", "üíÄ", 190)
createTab("Misc", "üîß", 270)
createTab("Hubs", "üåê", 350)

-- TDW Title
local TDWFrame = Instance.new("Frame")
TDWFrame.Size = UDim2.new(0, 30, 1, -26)
TDWFrame.Position = UDim2.new(0, 0, 0, 26)
TDWFrame.BackgroundTransparency = 1
TDWFrame.Parent = MainFrame

local sideLabels = {"T", "D", "W"}
for i, letter in ipairs(sideLabels) do
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0, 30, 0, 30)
    label.Position = UDim2.new(0, 0, 0, (i - 1) * 80 + 30)
    label.Text = letter
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 30
    label.TextColor3 = Color3.fromRGB(255, 0, 0)
    label.BackgroundTransparency = 1
    label.Parent = TDWFrame
end

-- Right Side Info Panel
local InfoPanel = Instance.new("Frame")
InfoPanel.Size = UDim2.new(0, 180, 1, 0)
InfoPanel.Position = UDim2.new(1, 0, 0, 0)
InfoPanel.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
InfoPanel.Parent = MainFrame

local Username = Instance.new("TextLabel")
Username.Size = UDim2.new(1, 0, 0, 20)
Username.Position = UDim2.new(0, 0, 0, 5)
Username.Text = "User:\nunknownhumanbeingfr"
Username.TextWrapped = true
Username.Font = Enum.Font.SourceSansBold
Username.TextSize = 14
Username.TextColor3 = Color3.fromRGB(0, 255, 0)
Username.BackgroundTransparency = 1
Username.Parent = InfoPanel

local Avatar = Instance.new("ImageLabel")
Avatar.Size = UDim2.new(0, 80, 0, 80)
Avatar.Position = UDim2.new(0.5, -40, 0, 30)
Avatar.BackgroundTransparency = 1
Avatar.Image = "rbxassetid://17174555482"
Avatar.Parent = InfoPanel

local FPS = Instance.new("TextLabel")
FPS.Size = UDim2.new(1, 0, 0, 20)
FPS.Position = UDim2.new(0, 0, 0, 120)
FPS.Text = "FPS: 44"
FPS.Font = Enum.Font.SourceSansBold
FPS.TextSize = 18
FPS.TextColor3 = Color3.fromRGB(0, 255, 0)
FPS.BackgroundTransparency = 1
FPS.Parent = InfoPanel

local Ping = Instance.new("TextLabel")
Ping.Size = UDim2.new(1, 0, 0, 20)
Ping.Position = UDim2.new(0, 0, 0, 145)
Ping.Text = "Ping: 93ms"
Ping.Font = Enum.Font.SourceSansBold
Ping.TextSize = 18
Ping.TextColor3 = Color3.fromRGB(0, 255, 0)
Ping.BackgroundTransparency = 1
Ping.Parent = InfoPanel

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local bringTargets = {}
local distance = 2

local function updateTeleportation()
	local char = LocalPlayer.Character
	local root = char and char:FindFirstChild("HumanoidRootPart")
	if not root then return end
	for _, name in ipairs(bringTargets) do
		local targetPlayer = Players:FindFirstChild(name)
		if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
			local target = targetPlayer.Character.HumanoidRootPart
			target.CFrame = CFrame.new(root.Position + root.CFrame.LookVector * distance, root.Position) * CFrame.Angles(0, math.rad(180), 0)
		end
	end
end

function loopBring(name)
	if table.find(bringTargets, name) then return end
	table.insert(bringTargets, name)
	coroutine.wrap(function()
		while table.find(bringTargets, name) do
			updateTeleportation()
			task.wait(0.05)
		end
	end)()
end

function stopBring(name)
	local i = table.find(bringTargets, name)
	if i then table.remove(bringTargets, i) end
end

-- Placeholder GUI components to prevent runtime errors
local LoopBringPanel = Instance.new("Frame")
LoopBringPanel.Name = "LoopBringPanel"
LoopBringPanel.Size = UDim2.new(0, 220, 0, 210)
LoopBringPanel.Position = UDim2.new(0, 110, 0, 40)
LoopBringPanel.BackgroundColor3 = Color3.fromRGB(25, 5, 5)
LoopBringPanel.BorderColor3 = Color3.fromRGB(200, 0, 0)
LoopBringPanel.BorderSizePixel = 1
LoopBringPanel.Visible = false
LoopBringPanel.Parent = MainFrame

local function createDummy(name)
	local btn = Instance.new("TextButton")
	btn.Name = name
	btn.Text = name
	btn.Size = UDim2.new(0, 100, 0, 25)
	btn.Parent = LoopBringPanel
	return btn
end

local function createDummyLabel(name)
	local lbl = Instance.new("TextLabel")
	lbl.Name = name
	lbl.Text = name
	lbl.Size = UDim2.new(0, 100, 0, 25)
	lbl.Parent = LoopBringPanel
	return lbl
end

local dropdownButton = createDummy("DropdownButton")
local dropdownFrame = Instance.new("Frame")
dropdownFrame.Name = "DropdownFrame"
dropdownFrame.Size = UDim2.new(0, 200, 0, 100)
dropdownFrame.Visible = false
dropdownFrame.Parent = LoopBringPanel

local scroll = Instance.new("ScrollingFrame")
scroll.Name = "ScrollingFrame"
scroll.Size = UDim2.new(1, 0, 1, 0)
scroll.Parent = dropdownFrame

local bringAllButton = createDummy("BringAllButton")
local removeAllButton = createDummy("RemoveAllButton")
local distanceLabel = createDummyLabel("DistanceLabel")
local plusButton = createDummy("PlusButton")
local minusButton = createDummy("MinusButton")
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 26)
titleBar.Parent = LoopBringPanel
local arrowButton = createDummy("ArrowButton")
arrowButton.Parent = titleBar
arrowButton.Position = UDim2.new(1, -36, 0, 4)

-- Helper function
local function createPlayerButton(playerName)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(1, -8, 0, 26)
	btn.Text = playerName
	btn.TextScaled = true
	btn.Font = Enum.Font.Gotham
	btn.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
	btn.TextColor3 = table.find(bringTargets, playerName) and Color3.new(1, 1, 1) or Color3.fromRGB(0, 255, 0)
	btn.AutoButtonColor = true
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 6)
	corner.Parent = btn
	if table.find(bringTargets, playerName) then
		local grad = Instance.new("UIGradient")
		grad.Color = ColorSequence.new{
			ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 0)),
			ColorSequenceKeypoint.new(1, Color3.fromRGB(120, 0, 0))
		}
		grad.Rotation = 45
		grad.Parent = btn
	end
	btn.MouseButton1Click:Connect(function()
		if table.find(bringTargets, playerName) then
			stopBring(playerName)
		else
			loopBring(playerName)
		end
		updatePlayerList()
	end)
	btn.Parent = scroll
end

function updatePlayerList()
	for _, child in ipairs(scroll:GetChildren()) do
		if child:IsA("TextButton") then
			child:Destroy()
		end
	end
	for _, p in ipairs(Players:GetPlayers()) do
		if p ~= LocalPlayer then
			createPlayerButton(p.Name)
		end
	end
	scroll.CanvasSize = UDim2.new(0, 0, 0, #Players:GetPlayers() * 28)
end

dropdownButton.MouseButton1Click:Connect(function()
	dropdownFrame.Visible = not dropdownFrame.Visible
	if dropdownFrame.Visible then updatePlayerList() end
end)

bringAllButton.MouseButton1Click:Connect(function()
	for _, p in ipairs(Players:GetPlayers()) do
		if p ~= LocalPlayer then loopBring(p.Name) end
	end
	updatePlayerList()
end)

removeAllButton.MouseButton1Click:Connect(function()
	bringTargets = {}
	updatePlayerList()
end)

plusButton.MouseButton1Click:Connect(function()
	distance += 1
	distanceLabel.Text = "Distance: " .. distance
end)

minusButton.MouseButton1Click:Connect(function()
	distance = math.max(1, distance - 1)
	distanceLabel.Text = "Distance: " .. distance
end)

Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(function(p)
	stopBring(p.Name)
	updatePlayerList()
end)

distanceLabel.Text = "Distance: " .. distance

LoopBringButton.MouseButton1Click:Connect(function()
	LoopBringPanel.Visible = not LoopBringPanel.Visible
end)
