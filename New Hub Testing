-- Existing script untouched except where changes are requested

-- Repositioned TDW Letters
local TDWFrame = Instance.new("Frame")
TDWFrame.Size = UDim2.new(0, 30, 1, -26)
TDWFrame.Position = UDim2.new(0, 5, 0, 26) -- Adjusted slightly to the right
TDWFrame.BackgroundTransparency = 1
TDWFrame.Parent = MainFrame

local sideLabels = {"T", "D", "W"}
for i, letter in ipairs(sideLabels) do
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0, 30, 0, 50)
    label.Position = UDim2.new(0, 0, 0, (i - 1) * 100 + 30)
    label.Text = letter
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 30
    label.TextColor3 = Color3.fromRGB(255, 0, 0)
    label.BackgroundTransparency = 1
    label.Parent = TDWFrame
end

-- Toggle Button for InfoPanel
local InfoToggle = Instance.new("TextButton")
InfoToggle.Size = UDim2.new(0, 25, 0, 25)
InfoToggle.Position = UDim2.new(1, -205, 0, 0)
InfoToggle.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
InfoToggle.BorderColor3 = Color3.fromRGB(255, 0, 0)
InfoToggle.Text = ">"
InfoToggle.Font = Enum.Font.SourceSansBold
InfoToggle.TextSize = 18
InfoToggle.TextColor3 = Color3.fromRGB(0, 255, 0)
InfoToggle.Parent = MainFrame

local infoVisible = true
InfoToggle.MouseButton1Click:Connect(function()
    infoVisible = not infoVisible
    InfoPanel.Visible = infoVisible
    InfoToggle.Text = infoVisible and ">" or "<"
end)

-- LoopBring Expandable Panel
local LoopBringPanel = Instance.new("Frame")
LoopBringPanel.Size = UDim2.new(0, 200, 1, -26)
LoopBringPanel.Position = UDim2.new(0, -200, 0, 26)
LoopBringPanel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
LoopBringPanel.BorderColor3 = Color3.fromRGB(255, 0, 0)
LoopBringPanel.BorderSizePixel = 2
LoopBringPanel.Visible = false
LoopBringPanel.Parent = MainFrame

-- Distance Manager
local PlusButton = Instance.new("TextButton")
PlusButton.Size = UDim2.new(0, 25, 0, 25)
PlusButton.Position = UDim2.new(0, 5, 0, 5)
PlusButton.Text = "+"
PlusButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
PlusButton.BorderColor3 = Color3.fromRGB(255, 0, 0)
PlusButton.TextColor3 = Color3.fromRGB(0, 255, 0)
PlusButton.Font = Enum.Font.SourceSansBold
PlusButton.TextSize = 18
PlusButton.Parent = LoopBringPanel

local MinusButton = Instance.new("TextButton")
MinusButton.Size = UDim2.new(0, 25, 0, 25)
MinusButton.Position = UDim2.new(0, 35, 0, 5)
MinusButton.Text = "-"
MinusButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
MinusButton.BorderColor3 = Color3.fromRGB(255, 0, 0)
MinusButton.TextColor3 = Color3.fromRGB(0, 255, 0)
MinusButton.Font = Enum.Font.SourceSansBold
MinusButton.TextSize = 18
MinusButton.Parent = LoopBringPanel

local LoopBringScroll = Instance.new("ScrollingFrame")
LoopBringScroll.Size = UDim2.new(1, -10, 1, -40)
LoopBringScroll.Position = UDim2.new(0, 5, 0, 35)
LoopBringScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
LoopBringScroll.ScrollBarThickness = 6
LoopBringScroll.BackgroundTransparency = 1
LoopBringScroll.Parent = LoopBringPanel

local playerButtons = {}
local function updatePlayerList()
    for _, btn in pairs(playerButtons) do btn:Destroy() end
    table.clear(playerButtons)

    local y = 0
    for _, player in ipairs(game.Players:GetPlayers()) do
        local btn = Instance.new("TextButton")
        btn.Size = UDim2.new(1, -10, 0, 25)
        btn.Position = UDim2.new(0, 0, 0, y)
        btn.Text = player.Name
        btn.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        btn.BorderColor3 = Color3.fromRGB(255, 0, 0)
        btn.TextColor3 = Color3.fromRGB(0, 255, 0)
        btn.Font = Enum.Font.SourceSansBold
        btn.TextSize = 14
        btn.Parent = LoopBringScroll
        y = y + 30
        table.insert(playerButtons, btn)
        -- TODO: add multiple selection handling & loopbring logic later
    end
    LoopBringScroll.CanvasSize = UDim2.new(0, 0, 0, y)
end

game.Players.PlayerAdded:Connect(updatePlayerList)
game.Players.PlayerRemoving:Connect(updatePlayerList)
updatePlayerList()

LoopBringButton.MouseButton1Click:Connect(function()
    LoopBringPanel.Visible = not LoopBringPanel.Visible
end)
